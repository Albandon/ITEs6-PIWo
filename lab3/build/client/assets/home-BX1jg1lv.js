import{d as F,f as S,c as B,a as A,u as L,w as D}from"./firebase-DaOuSY5x.js";import{a,o as e}from"./chunk-BAXFHI7N-C8WG0Srv.js";import{a as N}from"./BooksContext-mFaCNzkU.js";import{C as z}from"./CartContext--l4EGcdk.js";function T({book:s,onEdit:h,onDelete:n}){const{user:u}=a.useContext(N),{cart:c,dispatch:r}=a.useContext(z),l=c.some(o=>o.id===s.id),t=async()=>{const o=F(S,"books",s.id);await B(o),n&&n()};return e.jsxs("div",{className:"book-item",children:[e.jsx("div",{className:"book-cover-image",children:s.cover&&e.jsx("img",{src:s.cover,alt:"Okładka"})}),e.jsxs("div",{className:"book-information-main",children:[e.jsx("h3",{className:"book-title",children:s.title}),e.jsxs("p",{className:"book-author",children:["Autor: ",s.author]}),e.jsx("p",{className:"book-description",children:s.description})]}),e.jsxs("div",{className:"book-information-side",children:[e.jsxs("div",{className:"book-information-money",children:[e.jsx("div",{className:"book-price",children:s.price}),e.jsx("div",{className:"book-currency",style:{marginLeft:4},children:"zł"})]}),e.jsxs("div",{className:"book-page-number",children:[s.pages," stron"]}),e.jsx("button",{className:"book-down-button",style:{marginTop:"0.5em",background:l?"#ccc":"#ffeb3b"},disabled:l,onClick:()=>r({type:"ADD_TO_CART",book:s}),children:l?"W koszyku":"Dodaj do koszyka"}),u&&s.userId===u.uid&&e.jsxs("div",{className:"book-down-button-container",children:[e.jsx("button",{className:"book-down-button",onClick:()=>h(s),children:"Edytuj"}),e.jsx("button",{className:"book-down-button",onClick:t,children:"Usuń"})]})]})]},s.id)}function E({book:s,onClose:h,onSave:n}){const[u,c]=a.useState(s.title),[r,l]=a.useState(s.author),[t,o]=a.useState(s.description),[x,p]=a.useState(s.price),[j,m]=a.useState(s.pages),[C,v]=a.useState(s.image),[d,b]=a.useState(s.coverType),k=async i=>{i.preventDefault();const f={title:u,author:r,description:t,price:x,pages:j,cover:"/witcher.jpg",coverType:d};c(""),l(""),o(""),p(""),m(""),b(""),v(null),n&&n(),h(),(async g=>{const w=A.currentUser;await L(F(S,"books",s.id),{...g,userId:w?w.uid:null})})(f)};return e.jsxs("div",{className:"main-container-form",children:[e.jsx("h1",{className:"view-header",children:"Dodawanie ogłoszenia"}),e.jsxs("form",{className:"add-parameters-container",onSubmit:k,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"book-add-title",className:"add-book-label",children:"Tytuł"}),e.jsx("input",{id:"book-add-title",className:"add-book-value",type:"text",value:u,onChange:i=>c(i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"book-add-Author",className:"add-book-label",children:"Autor"}),e.jsx("input",{id:"book-add-Author",className:"add-book-value",type:"text",value:r,onChange:i=>l(i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"book-add-description",className:"add-book-label",children:"Opis"}),e.jsx("input",{id:"book-add-description",className:"add-book-value",type:"text",value:t,onChange:i=>o(i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"book-add-price",className:"add-book-label",children:"Cena"}),e.jsx("input",{id:"book-add-price",className:"add-book-value",type:"number",min:"0",value:x,onChange:i=>p(i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"book-add-page-number",className:"add-book-label",children:"Liczba stron"}),e.jsx("input",{id:"book-add-page-number",className:"add-book-value",type:"number",min:"1",value:j,onChange:i=>m(i.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-cover",className:"add-book-label",children:"Okładka"}),e.jsxs("select",{id:"filter-cover",className:"add-book-value",value:d,onChange:i=>b(i.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Wybierz"}),e.jsx("option",{value:"soft",children:"Miękka"}),e.jsx("option",{value:"hard",children:"Twarda"})]})]}),e.jsxs("div",{className:"book-add-title",children:[e.jsx("label",{htmlFor:"image",className:"add-book-label",children:"Okładka książki:"}),e.jsx("input",{type:"file",className:"add-book-value",accept:"image/*",onChange:i=>v(i.target.files[0]),required:!0})]}),e.jsxs("div",{children:[e.jsx("button",{className:"cart-links",type:"submit",children:"Zaktualizuj książkę"}),e.jsx("button",{className:"cart-links",type:"button",onClick:h,children:"Anuluj"})]})]})]})}function P({books:s}){const{user:h,showMine:n,setShowMine:u,getBookList:c}=a.useContext(N),[r,l]=a.useState(null);return e.jsxs("div",{className:"book-list-container",children:[h&&e.jsx("button",{onClick:()=>u(t=>!t),children:n?"Pokaż wszystkie":"MOJE"}),s.map(t=>e.jsx(T,{book:t,onDelete:c,onEdit:l},t.id)),r&&e.jsx("div",{className:"modal-backdrop",onClick:()=>l(null),children:e.jsx("div",{className:"modal-content",onClick:t=>t.stopPropagation(),children:e.jsx(E,{book:r,onClose:()=>l(null),onSave:c})})})]})}function q({setPriceFilter:s,setCoverFilter:h,setPageCountFilter:n,setAuthorFilter:u,setDescriptionFilter:c}){const r=l=>{const{id:t,value:o}=l.target;t==="filter-price"&&s(o),t==="filter-cover"&&h(o),t==="filter-page-count"&&n(o),t==="filter-page-Author"&&u(o),t==="filter-page-desc"&&c(o)};return e.jsxs("div",{className:"filters-bar",children:[e.jsx("h2",{className:"filters-header",children:"Filtry"}),e.jsxs("div",{className:"filters-bar-filters",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-price",className:"filters",children:"Cena"}),e.jsx("input",{id:"filter-price",className:"filters-value",type:"number",min:"0",onBlur:r})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-cover",className:"filters",children:"Okładka"}),e.jsxs("select",{id:"filter-cover",className:"filters-value",onBlur:r,children:[e.jsx("option",{value:"",children:"Wybierz"}),e.jsx("option",{value:"soft",children:"Miękka"}),e.jsx("option",{value:"hard",children:"Twarda"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-page-count",className:"filters",children:"Ilość stron"}),e.jsx("input",{id:"filter-page-count",className:"filters-value",type:"number",min:"1",onBlur:r})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-page-Author",className:"filters",children:"Autor"}),e.jsx("input",{id:"filter-page-Author",className:"filters-value",type:"search",onBlur:r})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"filter-page-desc",className:"filters",children:"Zawarty w opisie"}),e.jsx("input",{id:"filter-page-desc",className:"filters-value",type:"text",onBlur:r})]})]})]})}function Q(){return[{title:"LiBeer"},{name:"Opis",content:"Księgarnia internetowa"}]}const R=D(function(){const{booksList:h}=a.useContext(N),[n,u]=a.useState(""),[c,r]=a.useState(""),[l,t]=a.useState(""),[o,x]=a.useState(""),[p,j]=a.useState(""),[m,C]=a.useState(""),v=h.filter(d=>{const b=n===""||d.price<=n,k=c===""||d.coverType===c,i=l===""||d.pages<=l,f=o===""||d.author.toLowerCase().includes(o.toLowerCase()),y=p===""||d.description.toLowerCase().includes(p.toLowerCase()),g=d.title.toLowerCase().includes(m.toLowerCase())||d.author.toLowerCase().includes(m.toLowerCase());return b&&k&&i&&f&&y&&g});return e.jsxs("main",{children:[e.jsx("div",{className:"announcements-top-bar",children:e.jsx("div",{className:"search-bar",children:e.jsx("input",{type:"search",placeholder:"Szukasz jakiegoś tytułu?",value:m,onChange:d=>C(d.target.value)})})}),e.jsxs("div",{className:"main-container",children:[e.jsx(q,{setPriceFilter:u,setCoverFilter:r,setPageCountFilter:t,setAuthorFilter:x,setDescriptionFilter:j}),e.jsx(P,{books:v})]})]})});export{R as default,Q as meta};
